function display(e,t){void 0===t&&(t=3e3);var a=document.querySelector("#status");a.innerHTML=e,a.style.display="block",setTimeout(function(){a=document.querySelector("#status"),a.innerHTML="",a.style.display="none"},t)}function postForm(e){var t=this,a=this.getAttribute("data-callback");e.stopImmediatePropagation();var n=null;if(e.preventDefault(),e.stopPropagation(),!(t.className.indexOf("sending")>-1)){t.className+=" sending";var o=document.activeElement,s=!1;console.log(o.type),"submit"===o.type?s=!0:(o=t.querySelector("[type=submit]"),null!==o&&(s=!0)),s&&(n={e:o,html:o.innerHTML,className:o.className},o.style.width=o.getBoundingClientRect().width+"px",o.innerHTML='&nbsp;<img src="/assets/icons/loading.gif" class="loader-indicator">&nbsp;');var r=t.elements,i=t.querySelector(".loader")||!1;i&&(i.style.display="inline-block");var l=t.getAttribute("action"),c=t.getAttribute("method")||"post";return c=c.toLowerCase(),ajax[c](l,r,function(e){if(n&&(n.e.innerHTML=n.html,n=null),t.className=t.className.replace("sending",""),a)a(e);else try{if("{"!==e[0])return void ajaxLink({href:e,offline:!0});var o=JSON.parse(e);if(o.success===!0)if(o.hasOwnProperty("redirect")&&(window.location=o.redirect),o.hasOwnProperty("popup")){var s=o["class"]||"large-form",r=o.padding||"";ajaxLink({"class":s,href:o.popup,paddingTop:r,offline:!0})}else if(o.hasOwnProperty("replace")){var i=o["class"]||"text-center";t.parentNode.className+=" "+i,t.parentNode.innerHTML=o.replace}else o.hasOwnProperty("display")&&display(o.display),t.reset();else console.log("errors"),o.hasOwnProperty("form")&&markFormErrors(t,o.form),o.hasOwnProperty("popup")&&alert(o.popup)}catch(l){console.log("Exception parsing JSON: "+l.message),console.log(o);try{display(e)}catch(l){console.log("Display(data) Exception : "+l.message),alert("Stala sa neočakávaná chyba. Skúste neskôr, alebo nás kontaktujte telefonicky")}}}),!1}}function ajaxLink(){alert("ajaxLink function call")}var ajax={defaultContentType:"application/x-www-form-urlencoded",fileUpload:!1};ajax.send=function(e,t,a,n){var o=new XMLHttpRequest;o.open(a,e,!0),o.onreadystatechange=function(){4==o.readyState&&t(""!==o.responseType?o.response:o.responseText)},"POST"!=a||ajax.fileUpload||o.setRequestHeader("Content-type",ajax.defaultContentType),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(n),ajax.fileUpload=!1},ajax.get=function(e,t,a){var n=[];for(var o in t)""!==o&&""!==t[o]&&n.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));ajax.send(e+(0!==n.length?"?"+n.join("&"):""),a,"GET",null)},ajax.post=function(e,t,a){try{var n=[];if("[object Object]"==t.toString())for(var s in t)n.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));else{for(var r=document.activeElement.hasAttribute("type")?document.activeElement.getAttribute("type"):!1,i=[],l=0;l<t.length;l++)switch(t[l].type){case"select":case"select-multiple":for(var c=0,p=t[l].options.length;p>c;c++)t[l].options[c].selected&&n.push(encodeURIComponent(t[l].name)+"="+t[l].options[c].value);break;case"radio":t[l].checked&&n.push(encodeURIComponent(t[l].name)+"="+t[l].value);break;case"checkbox":t[l].checked&&n.push(encodeURIComponent(t[l].name)+"="+t[l].value||"on");break;case"submit":i.push(t[l]);break;case"file":if(void 0===window.FormData)return;for(var u=new FormData,c=0;c<t[l].files.length;c++){var d=t[l].files[c];console.log("file name: "+t[l].name),u.append(t[l].name,d,d.name)}ajax.fileUpload=!0,ajax.send(e,a,"POST",u);break;default:var f=encodeURIComponent(t[l].value);n.push(encodeURIComponent(t[l].name)+"="+f)}r&&("submit"===r?n.push(document.activeElement.name+"="+document.activeElement.value):i.length>0&&n.push(i[0].name+"="+i[0].value))}if(0===n.length||"="===n.toString())return;ajax.send(e,a,"POST",n.join("&"))}catch(m){display(m.message)}},document.addEventListener("DOMContentLoaded",function(){console.log("Document Ready!");for(var e=document.getElementsByClassName("ajax"),t=0,a=e.length;a>t;t++)"form"===e[t].tagName.toLowerCase()?e[t].addEventListener("submit",postForm):e[t].addEventListener("submit",ajaxLink)});
